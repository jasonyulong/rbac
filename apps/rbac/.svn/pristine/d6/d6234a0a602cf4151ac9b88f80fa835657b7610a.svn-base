/*!
 * Start Bootstrap - Admin v3.3.7+1 (https://github.com/KevinsDeveloper/bootstrap4-admin)
 * Copyright 2013-2019 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap/blob/gh-pages/LICENSE)
 */
define(["jquery","bootstrap","bootstrap-select","template","form-validator","laydate"],function(e,t,t,a,n,i){var c={laydate:function(e,t){i.render({elem:e,type:t,theme:"molv",max:1})},open:function(t,a,n,i){e(t).click(function(){var t=e(this).attr("data-url")||"",c=a||"编辑";Fast.api.open(t,c,{area:[n,i]})})},cancel:function(t){e(t).click(function(){parent.layer.closeAll()})},checked:function(t,a){e(t).click(function(){if(2==a)for(var t=e(this),n=t.is(":checked"),i=e(".data-check_box"),c=0;c<i.length;c++)e(i[c]).prop("checked",n);e(".box_total").html(e("input[name=box_checked]:checked").length)})},checkedId:function(t){for(var a=[],n=e(".data-check_box"),i=0;i<n.length;i++)if(e(n[i]).is(":checked")){var c=e(n[i]).attr(t);c=e.trim(c),c&&a.push(c)}return a},oneCheckId:function(t){e(t).click(function(){e(".box_total").html(e("input[name='box_checked']:checked").length)})},reminder:function(e){parent.layer.open({type:1,maxmin:!0,shadeClose:!0,scrollbar:!1,area:["500px","500px"],content:e})},del:function(t,a,n){var a=a||"删除？";layer.confirm("确定要删除吗?",{icon:3,title:a},function(a){var i=e(t).attr("data-url");e.post(i,{ids:n},function(t){if(t.code>0){var a="";e.each(t.data,function(e,t){var n=t.success?"":"error";a+='<p class="'+n+'">'+e+". "+t.msg+"</p>"});var n='<div class="layer-content">'+a+"</div>";c.reminder(n)}},"json"),layer.close(a)})}},r={_initialize:function(){e(".selectpicker").selectpicker({selectAllText:"全选",deselectAllText:"取消",liveSearch:!0}),e.validator.setTheme("bootstrap",{validClass:"has-success",invalidClass:"has-error",bindClassTo:".form-group",formClass:"n-default n-bootstrap",msgClass:"n-right"})},index:function(){var t={addusername:".addusername",editusername:".editusername",del:".del",bathdel:".bathdel",editrule:".editrule",addobj:".addobj"};c.checked(".data-check_box_total",2),c.checked(".data-check_box",1),c.cancel("#cancel"),c.laydate("#preentrytime","datetime"),c.laydate("#proceduretime","datetime"),c.laydate("#start_time","date"),c.laydate("#end_time","date"),c.open(t.addusername,"添加","700px","730px"),e(".savePending").click(function(){var t=c.checkedId("data-id"),a=e(".savePending").attr("data-url");return 0==t.length?(layer.msg("请选择要操作的用户!",{time:2e3}),!1):void layer.confirm("确定要转吗?",{icon:3,title:"操作"},function(n){e.post(a,{id:t,status:2},function(t){if(t.code>0){var a="";e.each(t.data,function(e,t){var n=t.success?"":"error";a+='<p class="'+n+'">'+e+". "+t.msg+"</p>"});var n='<div class="layer-content">'+a+"</div>";c.reminder(n)}}),layer.close(n)})}),c.open(t.editusername,"编辑","700px","560px"),e(t.addobj).click(function(){var t=e(this).attr("data-url");layer.open({type:2,shade:!1,area:["580px","400px"],maxmin:!0,content:t,zIndex:layer.zIndex})}),e(".allow").click(function(){if(e(this).prop("checked"))var t=!0;else var t=!1;e(this).siblings(".child").find("input[type='checkbox']").prop("checked",t)}),e(t.editrule).click(function(){var t=c.checkedId("data-id"),a=t.length;if(a<=0)return layer.msg("请选择用户!",{time:2e3}),!1;var n=t.join(","),i=e(this).attr("data-url"),r=i+"&ids="+n;Fast.api.open(r,"编辑",{area:["700px","470px"]})}),e(t.bathdel).click(function(){var a=e(this).attr("datas-id"),n=[];if("undefined"==typeof a){var n=c.checkedId("data-id");if(0==n.length)return layer.msg("请选择要删除的用户!",{time:2e3}),!1}else n=a.split(",");c.del(t.bathdel,"删除？",n)}),e(".notes").click(function(){var t=e(this).attr("data-url");if(!e(this).find("textarea").val()){var a=e(this).text();e(this).html("<textarea rows='2' cols='15'>"+a+"</textarea>"),e(this).find("textarea").focus(),e(this).find("textarea").blur(function(){var a=e(this).val(),n=e(this).parent("div.notes"),i=n.attr("id");e.post(t,{id:i,note:a},function(e){e.code>0?layer.msg(e.msg):layer.msg(e.msg)},"json"),n.html(a)})}})}};return r});