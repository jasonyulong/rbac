/*!
 * Start Bootstrap - Admin v3.3.7+1 (https://github.com/KevinsDeveloper/bootstrap4-admin)
 * Copyright 2013-2019 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap/blob/gh-pages/LICENSE)
 */
define(["jquery","bootstrap","template","form-validator"],function($,undefined,template,undefined){var require=requirejs.s.contexts._.config.config,Fast={config:{ajax:".btn-ajax",dialog:".btn-dialog",dialogForm:".dialog-form",refresh:".btn-refresh",isexplode:".is_explode",require:"object"==typeof require?require:JSON.parse(require),accessRequest:!1},events:{success:function(e){layer.alert(e)},error:function(e){layer.alert(e)},onAjaxSuccess:function(e,t){var a="undefined"!=typeof e.data?e.data:null,o="undefined"!=typeof e.msg&&e.msg?e.msg:__("Operation completed");if("function"==typeof t){var r=t.call(this,a,e);if(r===!1)return}Fast.events.success(o)},onAjaxError:function(e,t){var a="undefined"!=typeof e.data?e.data:null;if("function"==typeof t){var o=t.call(this,a,e);if(o===!1)return}Fast.events.error(e.msg)},onAjaxResponse:function(e){try{var t="object"==typeof e?e:JSON.parse(e);t.hasOwnProperty("code")||$.extend(t,{code:-2,msg:e,data:null})}catch(a){var t={code:-1,msg:a.message,data:null}}return t},access:function(){if(Fast.config.accessRequest)return!1;Fast.config.accessRequest=!0;var e=require.config.controllername;if("login"==e)return Fast.config.accessRequest=!1,!0;var t=require.config.modulename+"/"+require.config.controllername+"/"+require.config.actionname,a={url:require.config.urls.access_url,data:{url:t},noload:!0},o=function(e,t){return Fast.config.accessRequest=!1,!1},r=function(e,t){return Fast.config.accessRequest=!1,!(!t||!t.url)&&(location.href=t.url,!1)};Fast.api.ajax(a,o,r),setTimeout(function(){Fast.events.access()},1e4),Fast.config.accessRequest=!1},explode:function(){var e=window.location.href,t="is_export=1";e+=(e.indexOf("?")==-1?"?":"&")+t,window.open(e,"_blank")}},api:{ajax:function(e,t,a){e="string"==typeof e?{url:e}:e;var o="undefined"==typeof e.noload&&layer.load();e=$.extend({type:"POST",dataType:"json",success:function(e){layer.close(o),e=Fast.events.onAjaxResponse(e),1===e.code?Fast.events.onAjaxSuccess(e,t):Fast.events.onAjaxError(e,a)},error:function(e){layer.close(o);var t={code:e.status,msg:e.statusText,data:null};Fast.events.onAjaxError(t,a)}},e),$.ajax(e)},open:function(e,t,a){t=t?t:"弹窗窗口",e=e+(e.indexOf("?")>-1?"&":"?")+"dialog=1";var o=[$(window).width()>800?"800px":"95%",$(window).height()>600?"600px":"95%"];return a=$.extend({type:2,title:t,shadeClose:!0,shade:.8,maxmin:!0,moveOut:!0,area:o,content:e,zIndex:layer.zIndex,success:function(e,t){var a=this;$(e).data("callback",a.callback),layer.setTop(e);try{var o=layer.getChildFrame("html",t),r=o.find(".layer-footer");if(Fast.api.layerfooter(e,t,a),r.size()>0){var n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(n){var i=r[0],s=new n(function(o){Fast.api.layerfooter(e,t,a),o.forEach(function(e){})}),c={attributes:!0,childList:!0,characterData:!0,subtree:!0};s.observe(i,c)}}}catch(l){}$(e).height()>$(window).height()&&layer.style(t,{top:0,height:$(window).height()})}},a?a:{}),($(window).width()<480||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&top.$(".tab-pane.active").size()>0)&&(a.area=[top.$(".tab-pane.active").width()+"px",top.$(".tab-pane.active").height()+"px"],a.offset=[top.$(".tab-pane.active").scrollTop()+"px","0px"]),layer.open(a)},layerfooter:function(e,t,a){var o=layer.getChildFrame("html",t),r=o.find(".layer-footer");if(r.size()>0){$(".layui-layer-footer",e).remove();var n=$("<div />").addClass("layui-layer-btn layui-layer-footer");n.html(r.html()),0===$(".row",n).size()&&$(">",n).wrapAll("<div class='row'></div>"),n.insertAfter(e.find(".layui-layer-content")),n.on("click",".btn",function(){$(this).hasClass("disabled")||$(this).parent().hasClass("disabled")||$(".btn:eq("+$(this).index()+")",r).trigger("click")});var i=e.find(".layui-layer-title").outerHeight()||0,s=e.find(".layui-layer-btn").outerHeight()||0;$("iframe",e).height(e.height()-i-s)}if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){var i=e.find(".layui-layer-title").outerHeight()||0,s=e.find(".layui-layer-btn").outerHeight()||0;$("iframe",e).parent().css("height",e.height()-i-s),$("iframe",e).css("height","100%")}},rendertree:function(e){$("#treeview").on("redraw.jstree",function(e){$(".layer-footer").attr("domrefresh",Math.random())}).jstree({themes:{stripes:!0},checkbox:{keep_selected_style:!1},types:{root:{icon:"fa fa-folder-open"},menu:{icon:"fa fa-folder-open"},file:{icon:"fa fa-file-o"}},plugins:["checkbox","types"],core:{check_callback:!0,data:e}})}},layer:{},init:function(){$(window).keyup(function(e){if(27==e.keyCode&&$(".layui-layer").size()>0){var t=0;$(".layui-layer").each(function(){t=Math.max(t,parseInt($(this).attr("times")))}),t&&layer.close(t)}}),$(document).on("click",Fast.config.ajax,function(e){var that=this,options=eval("("+$(that).attr("options")+")")||{},options=$.extend(options,$(that).data()||{});"undefined"==typeof options.url&&$(that).attr("href")&&(options.url=$(that).attr("href"));var success="function"==typeof options.success?options.success:null,error="function"==typeof options.error?options.error:null;return options.success=function(e,t){var t=e.data||{};return t&&t.url?(location.href=t.url,!1):(layer.alert(e.msg,{closeBtn:0},function(e){window.name,parent.layer.close(e),parent.window.location.reload(),window.location.reload()}),!1)},options.error=function(e){return Fast.events.error(e.msg),!1},"undefined"!=typeof options.confirm?layer.confirm(options.confirm,function(e){Fast.api.ajax(options,success,error),layer.close(e)}):Fast.api.ajax(options,success,error),!1}),$(document).on("click",Fast.config.dialog,function(e){var that=this,title=$(that).attr("title")||"弹窗窗口",url=$(that).attr("href")||"";"#"!=url&&""!=url||(url=$(that).attr("data-url")||url);var options=eval("("+$(that).attr("data-options")+")")||{};return Fast.api.open(url,title,options)}),$(document).on("click",Fast.config.refresh,function(e){window.location.reload()}),$(Fast.config.dialogForm).on("valid.form",function(){var e=this,t=$.extend({},$(e).data()||{});"undefined"==typeof t.url&&$(e).attr("action")&&(t.url=$(e).attr("action")),t.data=$(e).serialize(),t.success=function(e,t){return e&&e.url?(location.href=e.url,!1):t.code<1?(Fast.events.error(t.msg),!1):(layer.alert(t.msg,{closeBtn:0},function(e){window.name,parent.layer.close(e),parent.window.location.reload(),window.location.reload()}),!1)},t.error=function(e,t){return Fast.events.error(t.msg),!1};var a="function"==typeof t.success?t.success:null,o="function"==typeof t.error?t.error:null;delete t.success,delete t.error,"undefined"!=typeof t.confirm?layer.confirm(t.confirm,function(e){Fast.api.ajax(t,a,o),layer.close(e)}):Fast.api.ajax(t,a,o)}),$(Fast.config.isexplode).click(function(){return Fast.events.explode()})}};window.Fast=Fast,Fast.init()});