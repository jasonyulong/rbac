/*!
 * Start Bootstrap - Admin v3.3.7+1 (https://github.com/KevinsDeveloper/bootstrap4-admin)
 * Copyright 2013-2019 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap/blob/gh-pages/LICENSE)
 */
define(["jquery","bootstrap","bootstrap-select","template","form-validator","laydate"],function(e,t,t,a,i,n){var c={laydate:function(e,t){n.render({elem:e,type:t,theme:"molv",max:1})},open:function(t,a,i,n){e(t).click(function(){var t=e(this).attr("data-url")||"",c=a||"编辑";Fast.api.open(t,c,{area:[i,n]})})},cancel:function(t){e(t).click(function(){parent.layer.closeAll()})},checked:function(t,a){e(t).click(function(){if(2==a)for(var t=e(this),i=t.is(":checked"),n=e(".data-check_box"),c=0;c<n.length;c++)e(n[c]).prop("checked",i);e(".box_total").html(e("input[name=box_checked]:checked").length)})},checkedId:function(t){for(var a=[],i=e(".data-check_box"),n=0;n<i.length;n++)if(e(i[n]).is(":checked")){var c=e(i[n]).attr(t);c=e.trim(c),c&&a.push(c)}return a},oneCheckId:function(t){e(t).click(function(){e(".box_total").html(e("input[name='box_checked']:checked").length)})},reminder:function(e){parent.layer.open({type:1,maxmin:!0,shadeClose:!0,scrollbar:!1,area:["500px","500px"],content:e})},del:function(t,a,i){var a=a||"删除？";layer.confirm("确定要删除吗?",{icon:3,title:a},function(a){var n=e(t).attr("data-url");e.post(n,{ids:i},function(t){if(t.code>0){var a="";e.each(t.data,function(e,t){var i=t.success?"":"error";a+='<p class="'+i+'">'+e+". "+t.msg+"</p>"});var i='<div class="layer-content">'+a+"</div>";c.reminder(i)}},"json"),layer.close(a)})}},r={_initialize:function(){e(".selectpicker").selectpicker({selectAllText:"全选",deselectAllText:"取消",liveSearch:!0}),e.validator.setTheme("bootstrap",{validClass:"has-success",invalidClass:"has-error",bindClassTo:".form-group",formClass:"n-default n-bootstrap",msgClass:"n-right"})},index:function(){var t={addusername:".addusername",editusername:".editusername",del:".del",bathdel:".bathdel",editrule:".editrule",addobj:".addobj"};c.checked(".data-check_box_total",2),c.checked(".data-check_box",1),c.cancel("#cancel"),c.laydate("#preentrytime","datetime"),c.laydate("#proceduretime","datetime"),c.laydate("#start_time","date"),c.laydate("#end_time","date"),c.open(t.addusername,"添加","700px","730px"),e(".savePending").click(function(){var t=c.checkedId("data-id"),a=e(this).attr("data-url");return 0==t.length?(layer.msg("请选择要操作的用户!",{time:2e3}),!1):void layer.confirm("确定要此操作?",{icon:3,title:"批量操作"},function(i){e.post(a,{id:t,status:2},function(t){if(t.code>0){var a="";e.each(t.data,function(e,t){var i=t.success?"":"error";a+='<p class="'+i+'">'+e+". "+t.msg+"</p>"});var i='<div class="layer-content">'+a+"</div>";c.reminder(i)}}),layer.close(i)})}),c.open(t.editusername,"编辑","700px","560px"),e(t.addobj).click(function(){var t=e(this).attr("data-url");layer.open({type:2,shade:!1,area:["580px","400px"],maxmin:!0,content:t,zIndex:layer.zIndex})}),e(".allow").click(function(){if(e(this).prop("checked"))var t=!0;else var t=!1;e(this).siblings(".child").find("input[type='checkbox']").prop("checked",t)}),e(t.editrule).click(function(){var t=c.checkedId("data-id"),a=e(this).attr("title"),i=t.length;if(i<=0)return layer.msg("请选择用户!",{time:2e3}),!1;var n=t.join(","),r=e(this).attr("data-url"),d=r+"&ids="+n;Fast.api.open(d,a,{area:["700px","470px"]})}),e(t.bathdel).click(function(){var a=e(this).attr("datas-id"),i=[];if("undefined"==typeof a){var i=c.checkedId("data-id");if(0==i.length)return layer.msg("请选择要删除的用户!",{time:2e3}),!1}else i=a.split(",");c.del(t.bathdel,"删除？",i)}),e(".notes").click(function(){var t=e(this).attr("data-url");if(!e(this).find("textarea").val()){var a=e(this).text();e(this).html("<textarea rows='2' cols='15'>"+a+"</textarea>"),e(this).find("textarea").focus(),e(this).find("textarea").blur(function(){var a=e(this).val(),i=e(this).parent("div.notes"),n=i.attr("id");e.post(t,{id:n,note:a},function(e){e.code>0?layer.msg(e.msg):layer.msg(e.msg)},"json"),i.html(a)})}})}};return r});